!function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=480,this.game.scale.minHeight=260,this.game.scale.maxWidth=640,this.game.scale.maxHeight=480,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.setScreenSize(!0)),this.game.state.start("preloader")}},window["space-boats"]=window["space-boats"]||{},window["space-boats"].Boot=t}(),function(){"use strict";function t(){}t.prototype={create:function(){var t=this.add.text(.5*this.game.width,.5*this.game.height,"Disconnected",{font:"42px Arial",fill:"#ffffff",align:"center"});t.anchor.set(.5),this.game.camera.follow(t)}},window["space-boats"]=window["space-boats"]||{},window["space-boats"].Disconnected=t}(),function(){"use strict";function t(){this.worldSize=640,this.starCount=300,this.cameraPos=new Phaser.Point(0,0),this.stars=[],this.players={}}var e=window["space-boats"];t.prototype.preload=function(){this.game.time.advancedTiming=!0,this.game.load.spritesheet("ship","/assets/ship.png",32,32),this.game.load.image("starfield","/assets/starfield.gif")},t.prototype.init=function(t){this.user=t.user,this.otherPlayers=t.otherPlayers},t.prototype.create=function(){var t=this;t.game.stage.disableVisibilityChange=!0,this.bgStars=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"starfield"),this.player=new e.obj.SpaceObject(this.game,"ship",this.game.width/2,this.game.height/2,180,200,250),this.player.socketOptions.emitPhysics=!0,this.player.user=this.user,this.game.world.setBounds(this.worldSize/2*-1+this.player.spr.x,this.worldSize/2*-1+this.player.spr.y,this.worldSize,this.worldSize),this.controls=new e.obj.PlayerControlsObject(this.game,this.player),this.player.spr.anchor.setTo(.5,.5),this.player.spr.angle=-90,this.game.camera.follow(this.player.spr),this.physicsUpdateCb=function(e){for(var s in e)if("player"===e[s].type&&t.players.hasOwnProperty(e[s].clientId)){var i=t.players[e[s].clientId];i.updatePhysics(e[s].physics)}},e.socket.on("physics:update",this.physicsUpdateCb),this.playerAddCb=function(s){if(s){var i=[];i=Array.isArray(s)?s:[s];for(var a in i){var o=i[a],r=new e.obj.SpaceObject(t.game,"ship",t.game.width/2,t.game.height/2,180,200,250);r.hyperspaceExit(),r.user=o.profile,r.socketOptions.emitPhysics=!1,r.socketOptions.watchPhysics=!0,t.players[o.clientId]=r}}},e.socket.on("player:add",this.playerAddCb),this.playerRemoveCb=function(e){t.players.hasOwnProperty(e.clientId)&&t.players[e.clientId].hyperspaceEnter(function(){t.game.world.remove(t.players[e.clientId].spr),delete t.players[e.clientId]})},e.socket.on("player:remove",this.playerRemoveCb),this.playerAddCb(this.otherPlayers),delete this.otherPlayers},t.prototype.shutdown=function(){e.socket.removeListener("physics:update",this.physicsUpdateCb),e.socket.removeListener("player:add",this.playerAddCb),e.socket.removeListener("player:remove",this.playerRemoveCb)},t.prototype.update=function(){this.controls.update(),this.player.update();for(var t in this.players)this.players[t].update();this.game.world.setBounds(this.worldSize/2*-1+this.player.spr.x,this.worldSize/2*-1+this.player.spr.y,this.worldSize,this.worldSize),this.bgStars.tilePosition.x=-this.player.spr.x,this.bgStars.tilePosition.y=-this.player.spr.y,this.bgStars.x=this.player.spr.x-this.game.width/2,this.bgStars.y=this.player.spr.y-this.game.height/2},t.prototype.render=function(){this.game.debug.text("x: "+(this.player.spr.x||"--"),2,16,"#00ff00"),this.game.debug.text("y: "+(this.player.spr.y||"--"),2,32,"#00ff00"),this.game.debug.text("fps: "+(this.game.time.fps||"--"),2,48,"#00ff00")},window["space-boats"]=window["space-boats"]||{},window["space-boats"].Game=t}(),window.loadGame=function(t){"use strict";var e=window["space-boats"],s=new Phaser.Game(640,480,Phaser.AUTO,"space-boats-game");e.socket=io(),s.state.add("boot",e.Boot),s.state.add("preloader",e.Preloader),s.state.add("disconnected",e.Disconnected),s.state.add("game",e.Game),e.socket.emit("account:login",t),e.socket.on("account:login:ack",function(e){e.ack&&s.state.start("game",!0,!0,{user:t,clientId:e.clientId,otherPlayers:e.otherPlayers})}),e.socket.on("disconnect",function(){s.state.start("disconnected")})},"function"!=typeof window.fbAsyncInit&&window.loadGame({id:1234567890,name:"Star Lord"}),function(){"use strict";function t(){this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.setPreloadSprite(this.asset),this.ready=!0},loadResources:function(){},create:function(){},update:function(){this.game.state.start("menu")},onLoadComplete:function(){}},window["space-boats"]=window["space-boats"]||{},window["space-boats"].Preloader=t}(),function(){"use strict";function t(){}window["space-boats"]=window["space-boats"]||{},window["space-boats"].obj=window["space-boats"].obj||{},window["space-boats"].obj.GameObject=t}(),function(){"use strict";function t(t,e,s){this.name=t||"",this._id=e||0,this.fbid=s||0}window["space-boats"]=window["space-boats"]||{},window["space-boats"].obj=window["space-boats"].obj||{},window["space-boats"].obj.PlayerAccountModel=t}(),function(){"use strict";function t(t,e){this.game=t,this.player=e,this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT,Phaser.Keyboard.UP,Phaser.Keyboard.DOWN])}var e=window["space-boats"];t.prototype=new e.obj.GameObject,t.prototype.constructor=t,t.prototype.update=function(){this.leftInputIsActive()?this.player.spr.body.angularVelocity=-this.player.rotationSpeed:this.rightInputIsActive()?this.player.spr.body.angularVelocity=this.player.rotationSpeed:this.player.spr.body.angularVelocity=0,this.upInputIsActive()?(this.player.spr.body.acceleration.x=Math.cos(this.player.spr.rotation)*this.player.acceleration,this.player.spr.body.acceleration.y=Math.sin(this.player.spr.rotation)*this.player.acceleration,this.player.spr.frame=1):(this.player.spr.body.acceleration.setTo(0,0),this.player.spr.frame=0)},t.prototype.leftInputIsActive=function(){var t=!1;return t=this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT),t|=this.game.input.activePointer.isDown&&this.game.input.activePointer.x<this.game.width/4},t.prototype.rightInputIsActive=function(){var t=!1;return t=this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT),t|=this.game.input.activePointer.isDown&&this.game.input.activePointer.x>this.game.width/2+this.game.width/4},t.prototype.upInputIsActive=function(){var t=!1;return t=this.game.input.keyboard.isDown(Phaser.Keyboard.UP),t|=this.game.input.activePointer.isDown&&this.game.input.activePointer.x>this.game.width/4&&this.game.input.activePointer.x<this.game.width/2+this.game.width/4},window["space-boats"]=window["space-boats"]||{},window["space-boats"].obj=window["space-boats"].obj||{},window["space-boats"].obj.PlayerControlsObject=t}(),function(){"use strict";function t(t,e,s,i,a,o,r){this.game=t,this.sprName=e,this.x=s,this.y=i,this.rotationSpeed=a,this.acceleration=o,this.maxSpeed=r,this.hyperspaceStep=null,this.hyperspaceMaxStep=10,this.hyperspaceMaxScale=20,this.hyperspaceDirection=0,this.hyperspaceCb=null,this.socketOptions={emitPhysics:!1,watchPhysics:!1},this.spr=this.game.add.sprite(this.x,this.y,this.sprName),this.spr.anchor.setTo(.5,.5),this.spr.angle=-90,this.game.physics.enable(this.spr,Phaser.Physics.ARCADE),this.spr.body.maxVelocity.setTo(this.maxSpeed,this.maxSpeed)}var e=window["space-boats"];t.prototype=new e.obj.GameObject,t.prototype.constructor=t,t.prototype.paused=function(){alert("ha"),this.spr.body.acceleration.setTo(0,0),this.update()},t.prototype.hyperspaceEnter=function(t){null===this.hyperspaceStep&&(this.hyperspaceStep=1,this.hyperspaceDirection=1,this.spr.anchor.setTo(0,.5),this.hyperspaceCb=t||null)},t.prototype.hyperspaceExit=function(t){null===this.hyperspaceStep&&(this.hyperspaceStep=this.hyperspaceMaxStep,this.hyperspaceDirection=-1,this.spr.anchor.setTo(1,.5),this.hyperspaceCb=t||null)},t.prototype.update=function(){this.spr.x>this.game.world.bounds.x+this.game.world.bounds.width&&(this.spr.x=this.game.world.bounds.x),this.spr.x<this.game.world.bounds.x&&(this.spr.x=this.game.world.bounds.x+this.game.world.bounds.width),this.spr.y>this.game.world.bounds.y+this.game.world.bounds.height&&(this.spr.y=this.game.world.bounds.y),this.spr.y<this.game.world.bounds.y&&(this.spr.y=this.game.world.bounds.y+this.game.world.bounds.height),this.socketOptions.emitPhysics&&e.socket.emit("physics:update",{x:this.spr.x,y:this.spr.y,body:{angularVelocity:this.spr.body.angularVelocity,acceleration:{x:this.spr.body.acceleration.x,y:this.spr.body.acceleration.y},velocity:{x:this.spr.body.velocity.x,y:this.spr.body.velocity.y}},rotation:this.spr.rotation}),null!==this.hyperspaceStep&&this.hyperspaceDirection>0&&this.hyperspaceStep<this.hyperspaceMaxStep?(this.hyperspaceStep++,this.spr.scale.x=this.hyperspaceStep*(this.hyperspaceMaxScale/this.hyperspaceMaxStep)):null!==this.hyperspaceStep&&this.hyperspaceDirection<0&&this.hyperspaceStep>1?(this.hyperspaceStep--,this.spr.scale.x=this.hyperspaceStep*(this.hyperspaceMaxScale/this.hyperspaceMaxStep)):null!==this.hyperspaceStep&&(this.hyperspaceStep=null,this.spr.scale.x=1,this.spr.anchor.setTo(.5,.5),"function"==typeof this.hyperspaceCb&&(this.hyperspaceCb(),this.hyperspaceCb=null))},t.prototype.updatePhysics=function(t){this.socketOptions.watchPhysics&&(this.spr.x=t.x,this.spr.y=t.y,this.spr.rotation=t.rotation,this.spr.body.angularVelocity=t.body.angularVelocity,this.spr.body.acceleration.x=t.body.acceleration.x,this.spr.body.acceleration.y=t.body.acceleration.y,this.spr.body.velocity.x=t.body.velocity.x,this.spr.body.velocity.y=t.body.velocity.y,0!==this.spr.body.acceleration.x&&0!==this.spr.body.acceleration.y?this.spr.frame=1:this.spr.frame=0)},window["space-boats"]=window["space-boats"]||{},window["space-boats"].obj=window["space-boats"].obj||{},window["space-boats"].obj.SpaceObject=t}();